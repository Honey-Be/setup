#!/bin/sh

for i in `find /sys/devices/ -name modalias |grep pci`
do
	modlist="$modlist $(modprobe --show-depends `cat $i` 2>/dev/null \
		|sed 's|.*/\(.*\).ko\(.gz\|\)|\1|')"
done

for i in $modlist
do
	echo modprobe $i
	modprobe $i
done
